#!/bin/sh -ex

apt-get update

# python3-apt is required for bindep in tox ansible job
apt-get install -y \
    ansible \
    cron \
    curl \
    equivs \
    git \
    jq \
    lintian \
    lsof \
    make \
    python3-apt \
    python3-dev \
    python3-pip \
    python3-venv \
    sed \
    tar \
    unzip

# Remove the EXTERNALLY-MANAGED file to let pip install packages globally
export PYTHON_VERSION=$(echo "$(python --version)" | cut -d' ' -f2 | cut -d. -f1,2)
rm -f "/usr/lib/python${PYTHON_VERSION}/EXTERNALLY-MANAGED"
pip install tox

systemctl enable cron
