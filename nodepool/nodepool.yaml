---
# https://zuul-ci.org/docs/nodepool/configuration.html#attr-diskimages
diskimages:
  # - name: img-debian-11
  #   release: bullseye
  #   # https://zuul-ci.org/docs/nodepool/configuration.html#attr-diskimages.elements
  #   elements:
  #     - debian
  #     # Those live in /usr/share/sf-elements
  #     - nodepool-minimal
  #     - zuul-worker-user
  #     # Our own elements in this repository's /nodepool/elements folder
  #     - wazo
  #   env-vars:
  #     # Remove bullseye-backports, which is added by default on diskimage-builder <3.39.0-4
  #     DIB_APT_SOURCES_CONF: |
  #       default:deb http://deb.debian.org/debian bullseye main
  #       updates:deb http://deb.debian.org/debian bullseye-updates main
  #       security:deb http://security.debian.org/ bullseye-security main
  #   python-path: /usr/bin/python3

  - name: img-debian-12
    release: bookworm
    # https://zuul-ci.org/docs/nodepool/configuration.html#attr-diskimages.elements
    elements:
      - debian
      # Those live in /usr/share/sf-elements
      - nodepool-minimal
      - zuul-worker-user
      # Our own elements in this repository's /nodepool/elements folder
      - wazo
    python-path: /usr/bin/python3

labels:
  # - name: vm-debian-11-m1s
  #   min-ready: 2
  # - name: vm-debian-11-m1m
  #   min-ready: 1
  - name: vm-debian-12-m1s
    min-ready: 2
  - name: vm-debian-12-m1m
    min-ready: 1

providers:
  # - name: openstack2
  #   cloud: openstack2
  #   clean-floating-ips: true
  #   image-name-format: "{image_name}-{timestamp}"
  #   boot-timeout: 120
  #   rate: 10.0
  #   diskimages:
  #     - name: img-debian-11
  #       config-drive: true
  #   pools:
  #     - name: os-pool-m1s-bullseye
  #       max-servers: 5
  #       networks:
  #         - provider
  #       labels:
  #         - name: vm-debian-11-m1s
  #           flavor-name: wazo-sf-worker-small
  #           diskimage: img-debian-11
  #       availability-zones:
  #         - nova
  #     - name: os-pool-m1m-bullseye
  #       max-servers: 5
  #       networks:
  #         - provider
  #       labels:
  #         - name: vm-debian-11-m1m
  #           flavor-name: m1.medium
  #           diskimage: img-debian-11
  #       availability-zones:
  #         - nova
      # - name: os-pool-m1s-bookworm
      #   max-servers: 5
      #   networks:
      #     - provider
      #   labels:
      #     - name: vm-debian-12-m1s
      #       flavor-name: wazo-sf-worker-small
      #       diskimage: img-debian-12
      #   availability-zones:
      #     - nova
      # - name: os-pool-m1m-bookworm
      #   max-servers: 5
      #   networks:
      #     - provider
      #   labels:
      #     - name: vm-debian-12-m1m
      #       flavor-name: m1.medium
      #       diskimage: img-debian-12
      #   availability-zones:
      #     - nova
  - name: ec2-eu-west-1
    driver: aws
    region-name: eu-west-1
    object-storage:
       bucket-name: wazo-software-factory-disk-images
    diskimages:
      - name: img-debian-12
        username: debian
        connection-port: 22
        volume-size: 10
    pools:
      - name: m1m-bookworm
        max-servers: 1
        subnet-id: subnet-0cda0d5056f892394
        security-group-id: sg-0fc30744a6f419196
        labels:
          - name: vm-debian-12-m1m
            diskimage: img-debian-12
            instance-type: t3.medium
            key-name: nodepool
      - name: m1s-bookworm
        max-servers: 2
        subnet-id: subnet-0cda0d5056f892394
        security-group-id: sg-0066a22dd0dca29f0
        labels:
          - name: vm-debian-12-m1s
            diskimage: img-debian-12
            instance-type: t3.nano
            key-name: nodepool
